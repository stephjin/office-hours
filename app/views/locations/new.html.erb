  <!-- Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places"></script>

  <script>
    var map;
    var image = "http://fc06.deviantart.net/fs70/f/2012/037/4/5/gold_star_icon_by_midnight_flame-d4oxfby.png";
    var cafeInfo;
    var autocomplete;
    var place;

    function initialize () {
      var mapOptions = {
        zoom: 16
      };
      
      map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

      if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

          var originMarker = new google.maps.Marker({
            position: pos,
            map: map,
            icon: image,
            title: 'You are here!'
          });

          map.setCenter(pos);

          var request = {
            location: pos,
            radius: 2000,
            types: ['cafe']
          };

          cafeInfo = new google.maps.InfoWindow();
          var service = new google.maps.places.PlacesService(map);
          service.nearbySearch(request, callback);

          // input = new google.maps.places.Autocomplete(
          //   * @type {HTMLInputElement} (document.getElementById('userInput')),
          //   { types: [] });


          // place = 

        }, function() {
          handleNoGeolocation(true);
        });
      } else {
        handleNoGeolocation(false);
      }
    }

    function callback(results, status) {
      if(status == google.maps.places.PlacesServiceStatus.OK) {
        for (var i = 0; i < results.length; i++) {
          createMarker(results[i]);
        }
      }
    }

    function createMarker(place) {
      var cafeMarker = new google.maps.Marker({
        map: map,
        position: place.geometry.location
      });

      var cafeLat = place.geometry.location.lat();
      var cafeLng = place.geometry.location.lng();

      google.maps.event.addListener(cafeMarker, 'click', function() {

        cafeInfo.setContent('<p><strong>'+place.name+'</strong></p>' +
          '<p>'+place.vicinity+'</p>'+
          '<button onclick="saveLoc()"> Add to Favorite Locations</button>');
          // '<a href="/locations/new"> add</a>');
        cafeInfo.open(map, this);
      });
    }

    function saveLoc() {
      <% Location.create(name: ";2323", address: "3423 juice", description: "things") %>
      alert("Location added to favorites!");
    }


    function handleNoGeolocation(errorFlag) {
      if (errorFlag) {
        var content = 'Error: The Geolocation service failed.';
      } else {
        var content = 'Error: Your browser doesn\'t support geolocation.';
      }

      var options = {
        map: map,
        position: new google.maps.LatLng(60, 105),
        content: content
      };

      var infowindow = new google.maps.InfoWindow(options);
      map.setCenter(options.position);
    }







    google.maps.event.addDomListener(window, 'load', initialize);
  </script>
<body>
<!-- form partial here -->
  <div id="map-canvas"></div>
</body>